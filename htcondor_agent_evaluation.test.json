{
  "eval_set_id": "htcondor_agent_comprehensive_eval_set",
  "name": "HTCondor Agent Comprehensive Evaluation",
  "description": "Comprehensive evaluation test cases for the HTCondor MCP agent covering job management, session handling, and tool usage",
  "eval_cases": [
    {
      "eval_id": "initial_greeting_and_session_check",
      "conversation": [
        {
          "invocation_id": "eval-001-greeting",
          "user_content": {
            "parts": [
              {
                "text": "hi"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "Welcome! I can see you have 47 previous sessions. Would you like to continue your last session or start fresh?"
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {},
                "name": "list_user_sessions"
              }
            ],
            "intermediate_responses": []
          }
        }
      ],
      "session_input": {
        "app_name": "htcondor_mcp_client_agent",
        "user_id": "test_user",
        "state": {}
      }
    },
    {
      "eval_id": "start_fresh_session",
      "conversation": [
        {
          "invocation_id": "eval-002-fresh-session",
          "user_content": {
            "parts": [
              {
                "text": "start fresh"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "Okay, I've started a fresh session for you. What can I do for you today?"
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {},
                "name": "start_fresh_session"
              }
            ],
            "intermediate_responses": []
          }
        }
      ],
      "session_input": {
        "app_name": "htcondor_mcp_client_agent",
        "user_id": "test_user",
        "state": {}
      }
    },
    {
      "eval_id": "list_available_tools",
      "conversation": [
        {
          "invocation_id": "eval-003-list-tools",
          "user_content": {
            "parts": [
              {
                "text": "list all tools"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "Here are the HTCondor job management tools available, organized by category:\n\n**Basic Job Management:**\n*   `list_jobs` - List jobs with optional filtering (owner, status, limit)\n*   `get_job_status` - Get detailed status for a specific job cluster ID\n*   `submit_job` - Submit a new job with submit description\n\n**Advanced Job Information:**\n*   `get_job_history` - Get job execution history for a specific cluster ID\n\n**Reporting and Analytics:**\n*   `generate_job_report` - Generate comprehensive job reports\n*   `get_utilization_stats` - Get resource utilization statistics\n*   `export_job_data` - Export job data in various formats (JSON, CSV)\n\n**Context-Aware Tools (ADK Context Integration):**\n*   `save_job_report` - Save a job report as an artifact using ADK Context\n*   `load_job_report` - Load a previously saved job report using ADK Context\n*   `search_job_memory` - Search memory for job-related information using ADK Context\n*   `get_user_context_summary` - Get a comprehensive summary of the user's context and history\n*   `add_to_memory` - Add information to memory using ADK Context\n\n**Session Management:**\n*   `list_user_sessions` - List all your sessions\n*   `continue_last_session` - Continue your most recent session\n*   `continue_specific_session` - Continue a specific session by ID\n*   `start_fresh_session` - Start a completely new session\n*   `get_session_history` - Get full conversation history for a session\n*   `get_session_summary` - Get summary of what was done in a session\n*   `get_user_conversation_memory` - Get memory across all your sessions\n\nHow can I help you further?"
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {},
                "name": "list_htcondor_tools"
              }
            ],
            "intermediate_responses": []
          }
        }
      ],
      "session_input": {
        "app_name": "htcondor_mcp_client_agent",
        "user_id": "test_user",
        "state": {}
      }
    },
    {
      "eval_id": "list_running_jobs",
      "conversation": [
        {
          "invocation_id": "eval-004-running-jobs",
          "user_content": {
            "parts": [
              {
                "text": "show me running jobs"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "Here are the first 10 running jobs:\n\n| ClusterId | ProcId | Status | Owner        |\n|-----------|--------|--------|--------------|\n| 6690501   | 0      | Running | maclwong     |\n| 6690502   | 0      | Running | maclwong     |\n| 6690503   | 0      | Running | maclwong     |\n| 6690504   | 0      | Running | maclwong     |\n| 6690505   | 0      | Running | maclwong     |\n| 6690506   | 0      | Running | maclwong     |\n| 6690507   | 0      | Running | maclwong     |\n| 6690508   | 0      | Running | maclwong     |\n| 6690509   | 0      | Running | maclwong     |\n| 6690768   | 0      | Running | vcavaliere   |\n\nThere are a total of 491 running jobs."
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {
                  "status": "running",
                  "limit": 10
                },
                "name": "list_jobs"
              }
            ],
            "intermediate_responses": []
          }
        }
      ],
      "session_input": {
        "app_name": "htcondor_mcp_client_agent",
        "user_id": "test_user",
        "state": {}
      }
    },
    {
      "eval_id": "get_job_status",
      "conversation": [
        {
          "invocation_id": "eval-005-job-status",
          "user_content": {
            "parts": [
              {
                "text": "what is the status of the job 6689983"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "Job Status for Cluster 6689983:\n- **Status**: Held (5)\n- **Owner**: srettie\n- **Command**: sh\n- **Arguments**: -c /usr/local/bin/python3.12' '-m' 'distributed.cli.dask_worker' 'tls://sebastien-2erettie-40cern-2ech.dask.casadev.af.uchicago.edu:8786' '--name' 'CoffeaCasaCluster-1323' '--nthreads' '1' '--memory-limit' '3.00GiB' '--nanny' '--death-timeout' '180' '--protocol' 'tls://' '--tls-ca-file' '/etc/cmsaf-secrets/ca.pem' '--tls-cert' '/etc/cmsaf-secrets/hostcert.pem' '--tls-key' '/etc/cmsaf-secrets/hostcert.pem\n- **Working Directory**: /var/lib/condor/spool/9983/0/cluster6689983.proc0.subproc0\n\n**Resource Usage:**\n- CPUs: 1\n- Memory: 3072 MB (3 GB)\n- Disk: 1500 MB (1 GB)\n\n**Timing:**\n- Queue Date: 2025-08-05T08:26:07\n\n**Files:**\n- Input: /dev/null\n- Output: _condor_stdout\n- Error: _condor_stderr\n- Log: worker-6689983.log"
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {
                  "cluster_id": 6689983
                },
                "name": "get_job_status"
              }
            ],
            "intermediate_responses": []
          }
        }
      ],
      "session_input": {
        "app_name": "htcondor_mcp_client_agent",
        "user_id": "test_user",
        "state": {}
      }
    },
    {
      "eval_id": "get_job_history",
      "conversation": [
        {
          "invocation_id": "eval-006-job-history",
          "user_content": {
            "parts": [
              {
                "text": "what's the history of job 6689983"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "Job History for Cluster 6689983:\n- 2025-08-05T08:26:07: Job submitted (Idle)"
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {
                  "cluster_id": 6689983,
                  "limit": 50
                },
                "name": "get_job_history"
              }
            ],
            "intermediate_responses": []
          }
        }
      ],
      "session_input": {
        "app_name": "htcondor_mcp_client_agent",
        "user_id": "test_user",
        "state": {}
      }
    },
    {
      "eval_id": "get_utilization_stats",
      "conversation": [
        {
          "invocation_id": "eval-007-utilization",
          "user_content": {
            "parts": [
              {
                "text": "show me utilization stats for the last 7 days"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "Here are the utilization statistics for the last 7 days:\n\n- **Time Range**: 7d\n- **Total Jobs**: 1329\n- **Completed Jobs**: 25\n- **Completion Rate**: 1.88%\n- **Total CPU Time**: 3605174.0\n- **Total Memory Usage**: 495590\n- **Average Completion Time**: 3729.08\n- **CPU Utilization Percent**: 2.44%\n- **Memory Utilization Percent**: 2.67%\n- **System Capacity**:\n    - Total CPUs: 5852\n    - Total Memory (MB): 18510837"
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {
                  "time_range": "7d"
                },
                "name": "get_utilization_stats"
              }
            ],
            "intermediate_responses": []
          }
        }
      ],
      "session_input": {
        "app_name": "htcondor_mcp_client_agent",
        "user_id": "test_user",
        "state": {}
      }
    },
    {
      "eval_id": "save_job_report",
      "conversation": [
        {
          "invocation_id": "eval-008-save-report",
          "user_content": {
            "parts": [
              {
                "text": "save a report for job 6690501"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "I've successfully saved a job report for cluster 6690501 as an artifact.\n\n**Report Details:**\n- Report Name: job_6690501_report\n- Artifact ID: artifact_001\n- Cluster ID: 6690501\n- Generated: 2025-08-05T16:00:00\n\nYou can load this report later using the load_job_report tool."
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {
                  "cluster_id": 6690501,
                  "report_name": "job_6690501_report"
                },
                "name": "save_job_report"
              }
            ],
            "intermediate_responses": []
          }
        }
      ],
      "session_input": {
        "app_name": "htcondor_mcp_client_agent",
        "user_id": "test_user",
        "state": {}
      }
    },
    {
      "eval_id": "list_user_sessions",
      "conversation": [
        {
          "invocation_id": "eval-009-session-list",
          "user_content": {
            "parts": [
              {
                "text": "list all my sessions"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "Here's a list of your sessions:\n\n| session_id                           | created_at            | last_activity         | conversation_count |\n| -------------------------------------- | --------------------- | --------------------- | ------------------ |\n| 96236379-ff05-4dab-b481-f38480eb7566 | 2025-08-05 14:45:15 | 2025-08-05 14:51:00 | 28                 |\n| 44c9245d-641c-4299-9f55-8c69ef9818c5 | 2025-08-04 23:19:26 | 2025-08-05 14:45:14 | 79                 |\n| 387a4497-0963-45c3-8795-03daf0d7b877 | 2025-08-05 14:39:29 | 2025-08-05 14:39:29 | 1                  |\n| 6e0ed3c2-9e2f-4219-941e-23b94ef1b936 | 2025-08-04 23:25:43 | 2025-08-04 23:25:43 | 1                  |\n| b88c7269-c70b-411b-9b1e-fafce4d68cb1 | 2025-08-04 22:52:22 | 2025-08-04 23:19:25 | 8                  |\n| 602c4aed-50b9-4a9d-9c61-cee516e2c59c | 2025-08-04 22:23:47 | 2025-08-04 22:52:21 | 19                 |\n| 714abcdf-c8f7-4e2b-99c3-b729df93912b | 2025-08-04 22:18:18 | 2025-08-04 22:23:46 | 13                 |\n| ef3b329c-6c48-4566-9bbd-560866f9a8b5 | 2025-08-04 22:12:08 | 2025-08-04 22:18:17 | 10                 |\n| 50de3cde-9251-4a97-868b-eebfb96d492f | 2025-08-04 22:06:04 | 2025-08-04 22:12:07 | 8                  |\n| 655d8359-8752-4d4d-8b8a-d79a23bd61cf | 2025-08-04 22:02:29 | 2025-08-04 22:06:03 | 13                 |\n| 69e7ef23-13a7-45b7-bf60-540dee9b600b | 2025-08-04 21:55:25 | 2025-08-04 22:02:28 | 13                 |\n| d815fcda-e2b6-44e4-b2a6-8d09c8f3a820 | 2025-08-04 21:39:25 | 2025-08-04 21:55:24 | 41                 |\n| ff463f27-4b25-44e9-9940-cad842fae512 | 2025-08-04 21:47:51 | 2025-08-04 21:47:51 | 1                  |\n| ef741a1a-a9f9-4667-a500-fe3969673f0d | 2025-08-04 21:25:25 | 2025-08-04 21:39:24 | 37                 |\n| 3f18ed7c-e9fc-4fcc-bd73-87541222312a | 2025-08-04 21:32:41 | 2025-08-04 21:32:41 | 1                  |\n| 00b7f64f-7c4e-4d8c-9c38-f9320e7c762b | 2025-08-04 21:18:02 | 2025-08-04 21:25:24 | 14                 |\n| bae9bba5-8f59-4ac6-87dc-83698671a8bc | 2025-08-04 21:12:41 | 2025-08-04 21:18:01 | 14                 |\n| 9d20130d-715c-4329-b46b-2dd4532c4396 | 2025-08-04 21:06:16 | 2025-08-04 21:12:40 | 10                 |\n| 4a407a79-f027-46fd-ac21-af6a18d0afd3 | 2025-08-04 21:02:24 | 2025-08-04 21:06:15 | 22                 |\n| e1d3a143-e53a-4ef5-ae3c-5de840666833 | 2025-08-01 21:54:43 | 2025-08-04 21:02:23 | 39                 |\n| fd56ceb0-8599-4231-b28e-6d87f05fa4de | 2025-08-04 20:55:34 | 2025-08-04 20:55:34 | 1                  |\n| a7e68921-b599-421d-b167-6e7a4fe30ee1 | 2025-08-01 21:44:33 | 2025-08-01 21:54:42 | 22                 |\n| 11164bc5-3bff-41d6-b0d9-13245d1f76f6 | 2025-08-01 21:32:47 | 2025-08-01 21:44:32 | 43                 |\n| 74adab3b-ed86-476d-83ab-40b0d91248bd | 2025-08-01 21:37:24 | 2025-08-01 21:37:24 | 1                  |\n| 94dcaec2-8e81-4bb7-9fe3-23b306eb8a5e | 2025-08-01 21:25:34 | 2025-08-01 21:32:46 | 43                 |\n| 5533994e-40c2-4b64-b97d-3ad23508e0cf | 2025-08-01 21:29:52 | 2025-08-01 21:29:52 | 1                  |\n| 2dd8985d-ed8f-41bb-a2c3-2077a35c4374 | 2025-08-01 21:20:34 | 2025-08-01 21:25:33 | 19                 |\n| 80fc8c2f-ab0f-4a46-9cf6-17211348aa59 | 2025-08-01 21:11:56 | 2025-08-01 21:20:33 | 13                 |\n| 6dba140a-cce5-4d34-94bf-3b8ac9ab2ddd | 2025-08-01 21:18:34 | 2025-08-01 21:18:34 | 1                  |\n| 3902b990-f9f0-49e6-b87c-cf6f40b5d8da | 2025-08-01 21:14:47 | 2025-08-01 21:14:47 | 1                  |\n| cb8752fa-4de2-4949-9174-84ca9b8bdd88 | 2025-08-01 21:08:07 | 2025-08-01 21:11:55 | 5                  |\n| 74f51b86-08fd-458d-9d46-ced07bf99f1f | 2025-08-01 21:02:35 | 2025-08-01 21:08:06 | 5                  |\n| 1eea9774-fc57-4ff7-ae19-683ce3c35f46 | 2025-08-01 20:56:08 | 2025-08-01 21:02:34 | 9                  |\n| d9f851ed-e0a9-4be5-ac06-20864165c3fe | 2025-08-01 21:00:01 | 2025-08-01 21:00:01 | 1                  |\n| 508814c2-9956-4e1f-b7b3-e53cd754c383 | 2025-08-01 20:53:41 | 2025-08-01 20:56:08 | 5                  |\n| ba6056c6-1eca-4cce-b03a-4ef68210abc1 | 2025-08-01 17:29:32 | 2025-08-01 20:53:40 | 58                 |\n| 9756f840-94af-47f7-9f98-c93db59ccbc4 | 2025-08-01 20:50:37 | 2025-08-01 20:50:37 | 1                  |\n| fb6d938a-9405-4859-a66f-062716559d3d | 2025-08-01 15:42:06 | 2025-08-01 17:29:27 | 33                 |\n| 9bc5d035-8a96-4ae0-8db0-098e477848f6 | 2025-08-01 15:35:21 | 2025-08-01 15:42:05 | 15                 |\n| 99ad3399-4cec-4d5e-8fb7-d635d336371c | 2025-08-01 15:17:25 | 2025-08-01 15:35:20 | 31                 |\n| 8eeacfce-4f7e-41a9-b5f8-3c67be36afda | 2025-08-01 15:20:03 | 2025-08-01 15:20:03 | 1                  |\n| 2ba82bc8-6224-4f26-aa51-285d2f4d80c5 | 2025-08-01 15:10:04 | 2025-08-01 15:17:24 | 18                 |\n| ab64de88-c506-42d1-ae71-436bd7ceeac9 | 2025-08-01 14:55:31 | 2025-08-01 15:10:03 | 12                 |\n| a5e46a3c-3edc-45cb-ac63-9f19c4f0e560 | 2025-08-01 14:54:27 | 2025-08-01 14:55:27 | 12                 |\n| 36745c02-bda7-430b-b01c-98a8eb8d1928 | 2025-08-01 14:18:12 | 2025-08-01 14:54:23 | 5                  |\n| e4663329-396b-4d0b-bbd2-d493c4391c2a | 2025-07-31 20:05:18 | 2025-08-01 14:18:08 | 30                 |\n| 2f0a26ab-1236-4979-903c-b416962a5b28 | 2025-07-31 19:45:00 | 2025-07-31 20:23:49 | 10                 |\n| d07b6c99-ac10-4656-bb9b-24d64e35b2bc | 2025-07-31 19:45:24 | 2025-07-31 20:05:13 | 33                 |\n\nI can also switch to a specific session if you would like."
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {},
                "name": "list_user_sessions"
              }
            ],
            "intermediate_responses": []
          }
        }
      ],
      "session_input": {
        "app_name": "htcondor_mcp_client_agent",
        "user_id": "test_user",
        "state": {}
      }
    },
    {
      "eval_id": "session_management_flow",
      "conversation": [
        {
          "invocation_id": "eval-010-session-continue-invalid",
          "user_content": {
            "parts": [
              {
                "text": "can we go to this session d49e2c00-8d95-4d5a-83da-63da933e2c1f"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "It seems that session ID d49e2c00-8d95-4d5a-83da-63da933e2c1f is invalid or has expired. I am unable to switch to that session or retrieve its history and summary.\n\nWould you like to try a different session, or would you like me to list the valid sessions again?"
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {
                  "session_id": "d49e2c00-8d95-4d5a-83da-63da933e2c1f"
                },
                "name": "continue_specific_session"
              }
            ],
            "intermediate_responses": []
          }
        },
        {
          "invocation_id": "eval-011-session-continue-valid",
          "user_content": {
            "parts": [
              {
                "text": "e4663329-396b-4d0b-bbd2-d493c4391c2a can we go to this session"
              }
            ],
            "role": "user"
          },
          "final_response": {
            "parts": [
              {
                "text": "Okay, I have switched to session e4663329-396b-4d0b-bbd2-d493c4391c2a.\n\nHere's a summary of what happened in this session:\n\n- The session was started fresh on 2025-07-31.\n- You listed jobs.\n- You attempted to continue the last session.\n- The last activity in this session was on 2025-08-01.\n\nWhat would you like to do next?"
              }
            ],
            "role": "model"
          },
          "intermediate_data": {
            "tool_uses": [
              {
                "args": {
                  "session_id": "e4663329-396b-4d0b-bbd2-d493c4391c2a"
                },
                "name": "continue_specific_session"
              },
              {
                "args": {
                  "session_id": "e4663329-396b-4d0b-bbd2-d493c4391c2a"
                },
                "name": "get_session_summary"
              }
            ],
            "intermediate_responses": []
          }
        }
      ],
      "session_input": {
        "app_name": "htcondor_mcp_client_agent",
        "user_id": "test_user",
        "state": {}
      }
    }
  ]
} 